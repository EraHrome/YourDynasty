@model MatchesResultModel

@{
    ViewData["Title"] = "Matches Page";

    var response = Model.Recognize;
}

<!--
    *******************
    SLIDER
    *******************
    -->
<div class="top-header">
    <div class="total-grad"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="specs">
                    <div class="">
                        <img src="~/img/avatars/avatar3.png" height="42" alt="">
                    </div>
                </div>
                <div class="wrapper">
                    <div class="heading">@User.Identity.Name    <i class="fas fa-check"></i></div>
                    <h3 class="subheding">Премиум-подписка активна до 30.11.2022</h3>
                </div>
            </div>
        </div>
    </div>
</div>
<!--
    *******************
    WHY CHOOSE ELASTIC
    *******************
    -->
<section class="services classic sec-uping">
    <div class="container">
        <div class="service-wrap">
            <div class="row">
                <div class="col-sm-1 col-md-4">
                    <div class="service-section">
                        <div class="title">Генеалогическое древо</div>
                        <p class="subtitle">
                            Сохраните память о поколениях и найдите своих родственников
                        </p>
                        <a href="@Url.Action("GenealogyTree", "Recognize")" class="btn btn btn-default-green-fill">Перейти</a>
                    </div>
                </div>
                <div class="col-sm-12 col-md-4">
                    <div class="service-section-action service-section">
                        <div class="title">Поиск по фото</div>
                        <p class="subtitle">
                            Ищите людей в социальных сетях с помощью фотографий
                        </p>
                    </div>
                </div>
                <div class="col-sm-12 col-md-4">
                    <div class="service-section">
                        <div class="plans badge feat bg-green">Новое</div>
                        <div class="title">Запрос архивов</div>
                        <p class="subtitle">
                            Найдите данные о родственниках в открытых банках данных
                        </p>
                        <a href="/search/memorial" class="btn btn btn-default-green-fill">Перейти</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="shopping blog">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="wrap-blog">

                    <div class="row">
                        <div class="col-md-12 col-lg-12 mb-80">
                            <div class="heading comment">Мы нашли N подходящих людей:</div>
                            <div class="line"></div>

                            @if (response != null)
                            {
                                @foreach (var person in Model.Persons)
                                {
                                    <div class="media">
                                        <img class="media-object" src="@($"data:image/png;base64, {person.face.ImageBase64}")" alt="photo">
                                        <div class="media-body">
                                            <h4 class="media-heading">@(person.person == null ? "Имя не найдено" : person.person.Name)</h4>
                                            <div class="text-blog mt-0">
                                                <span>12.02.1999 г.р., Пензенская обл., Башмаковский р-н - спаршено откуда-то</span>
                                                <p class="overview-txt">
                                                    @($"Вероятность совпадения: {response.Results.FirstOrDefault(res => res.FaceUuid == Model.FaceId).Matches.FirstOrDefault(match => match.FaceUuid == person.face.Face.FaceUuid).Confidence}")
                                                </p>
                                                <p class="overview-txt">
                                                    @($"Предположительный возраст на фото: {person.face.Face.Tags.First(tag => tag.Name == "age").Value}")
                                                </p>
                                            </div>
                                            <div class="multirow-auto">
                                                <a class="goto-link" href=""> <div style="max-width: 250px" class="btn-listing btn-default-green-fill">На древо</div></a>
                                                <a class="goto-link" href="https://obd-memorial.ru/html/info.htm?id=5420874"> <div class="btn-listing btn-default-green-fill">Источник</div></a>
                                                <a class="goto-link" href=""> <div style="max-width: 100px" class="btn-listing btn-default-green-fill" person-form-btn="@person.face.Face.FaceUuid">Дополнить</div></a>
                                            </div>
                                        </div>
                                    </div>

                                    <hr>
                                    <form class="comments-form" person-additional-form="@person.face.Face.FaceUuid" action="@Url.Action("AddPerson", "Recognize")" hidden>
                                        <div class="multirow">
                                            <input id="middlename" type="text" name="middlename" placeholder="Фамилия" class="input tripleline" required>
                                            <input id="firstname" type="text" name="firstname" placeholder="Имя" class="input tripleline" required>
                                            <input id="surname" type="text" name="surname" placeholder="Отчество" class="input tripleline" required>
                                        </div>
                                        <div class="multirow">
                                            <input id="birthplace" type="text" name="birthplace" placeholder="Дата рождения" class="input doubleline" required>
                                            <input id="birthdate" type="text" name="birthdate" placeholder="Место рождения" class="input doubleline" required>
                                        </div>
                                        <div class="multirow">
                                            <input id="deathplace" type="text" name="deathplace" placeholder="Дата смерти" class="input tripleline" required>
                                            <input id="burialregion" type="text" name="burialregion" placeholder="Регион захоронения" class="input tripleline" required>
                                            <input id="burialplace" type="text" name="burialplace" placeholder="Место захоронения" class="input tripleline" required>
                                        </div>
                                        <input id="form-submit" type="submit" style="max-width: 125px" class="btn-listing btn-default-green-fill" value="Сохранить">
                                    </form>
                                }
                            }
                            @*<a href="" class="btn btn-default-green-fill">Загрузить еще</a>*@
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
